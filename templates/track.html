{% extends "base.html" %}
{% block content %}
<div class="container">
    <h2>{{ track.title }}</h2>
    <p>by <a href="{{ url_for('profile', username=track.user.username) }}" style="color:#ff69b4;">{{ track.user.username }}</a></p>

    <div class="music-card">
        {% if track.thumbnail %}
            <img src="{{ url_for('static', filename='uploads/' + track.thumbnail) }}" alt="Thumbnail" class="track-thumbnail">
        {% else %}
            <img src="{{ url_for('static', filename='images/default-track.png') }}" alt="Default Thumbnail" class="track-thumbnail">
        {% endif %}
        <h3>{{ track.title }}</h3>
        <audio controls>
            <source src="{{ url_for('static', filename='uploads/' + track.filename) }}" type="audio/mpeg">
        </audio>
        <p style="margin-top:10px;">{{ track.description }}</p>
    </div>

    <div class="comment-box">
        <h3>Comments</h3>
        {% for comment in comments %}
            <div class="music-card" style="padding:10px;">
                <strong>{{ comment.user.username }}</strong><br>
                <small>{{ comment.created_at.strftime('%Y-%m-%d %H:%M') }}</small>
                <p>{{ comment.text }}</p>
            </div>
        {% else %}
            <p>No comments yet.</p>
        {% endfor %}

        {% if current_user.is_authenticated %}
        <form method="POST" style="margin-top:15px;">
            {{ form.hidden_tag() }}
            {{ form.text.label }}<br>
            {{ form.text(rows=3) }}
            <button type="submit" class="btn">Post Comment</button>
        </form>
        {% else %}
        <p><a href="{{ url_for('login') }}" style="color:#ff69b4;">Login</a> to comment</p>
        {% endif %}
    </div>
</div>
{% endblock %}
